# ุฑุงูููุง ุญู ูุดฺฉูุงุช ุณุณุชู ูพุฑุฏุงุฎุช

## ๐ **ูุดฺฉูุงุช ุฑุงุฌ ู ุฑุงูโุญูโูุง**

### 1. **โ ุฎุทุง "invalid merchant" ุงุฒ ุฒุจุงู**

#### **ุนูุช:**
- API key ุฒุจุงู ูุนุชุจุฑ ูุณุช
- Merchant ุฏุฑ ุญุงูุช ุชุณุช ูุฑุงุฑ ุฏุงุฑุฏ
- Merchant ุบุฑูุนุงู ุงุณุช

#### **ุฑุงูโุญู:**
1. **ูุฑูุฏ ุจู ูพูู ุฒุจุงู:**
   - ุจู ุณุงุช [zibal.ir](https://zibal.ir) ุจุฑูุฏ
   - ูุงุฑุฏ ูพูู ฺฉุงุฑุจุฑ ุดูุฏ

2. **ุฏุฑุงูุช API Key ุตุญุญ:**
   - ุฏุฑ ุจุฎุด "ุชูุธูุงุช" โ "API"
   - Merchant ID ุตุญุญ ุฑุง ฺฉูพ ฺฉูุฏ

3. **ุจูโุฑูุฒุฑุณุงู AppConfig:**
   ```dart
   // ุฏุฑ ูุงู lib/config/app_config.dart
   static const String zibalMerchantId = 'MERCHANT_ID_ุฌุฏุฏ_ุดูุง';
   ```

4. **ุชุณุช ูุฌุฏุฏ:**
   - ุงูพูฺฉุดู ุฑุง restart ฺฉูุฏ
   - ุชุณุช ุณุฑุน ุฑุง ุงูุฌุงู ุฏูุฏ

### 2. **โ ุฎุทุง "ูุจูุบ ูุงุฑุฏ ุดุฏู ูุงูุนุชุจุฑ ุงุณุช"**

#### **ุนูุช:**
- ูุจูุบ ฺฉูุชุฑ ุงุฒ ุญุฏุงูู ูุฌุงุฒ ุงุณุช
- ูุฑูุช ูุจูุบ ุงุดุชุจุงู ุงุณุช

#### **ุฑุงูโุญู:**
- **ุญุฏุงูู ูุจูุบ ุฒุจุงู:** 10,000 ุชููุงู (100,000 ุฑุงู)
- **ุญุฏุงูู ูุจูุบ ุฒุฑูโูพุงู:** 1,000 ุชููุงู (10,000 ุฑุงู)

### 3. **โ ุฎุทุง ุงุชุตุงู ุจู ูพุงฺฏุงู ุฏุงุฏู**

#### **ุนูุช:**
- ุฌุฏุงูู ูพุฑุฏุงุฎุช ุงุฌุงุฏ ูุดุฏูโุงูุฏ
- RLS policies ุชูุธู ูุดุฏูโุงูุฏ

#### **ุฑุงูโุญู:**
1. **ุงุฌุฑุง SQL Script:**
   ```sql
   -- ูุงู create_payment_tables.sql ุฑุง ุฏุฑ Supabase ุงุฌุฑุง ฺฉูุฏ
   ```

2. **ุจุฑุฑุณ ุฌุฏุงูู:**
   - `payment_transactions`
   - `subscriptions`
   - `wallets`
   - `discount_codes`

### 4. **โ ุฎุทุง RLS (Row Level Security)**

#### **ุนูุช:**
- Policies ุชูุธู ูุดุฏูโุงูุฏ
- ฺฉุงุฑุจุฑ ุฏุณุชุฑุณ ูุฏุงุฑุฏ

#### **ุฑุงูโุญู:**
1. **ุจุฑุฑุณ Policies:**
   ```sql
   SELECT * FROM pg_policies WHERE tablename = 'payment_transactions';
   ```

2. **ุงุฌุงุฏ Policy:**
   ```sql
   CREATE POLICY "Users can view their own transactions" 
   ON payment_transactions FOR SELECT 
   USING (auth.uid() = user_id);
   ```

### 5. **โ ุฎุทุง "ฺฉุฏ ุชุฎูู ูุงูุนุชุจุฑ"**

#### **ุนูุช:**
- ฺฉุฏ ุชุฎูู ูุฌูุฏ ูุฏุงุฑุฏ
- ฺฉุฏ ูููุถ ุดุฏู ุงุณุช
- ฺฉุฏ ูุจูุงู ุงุณุชูุงุฏู ุดุฏู ุงุณุช

#### **ุฑุงูโุญู:**
1. **ุจุฑุฑุณ ฺฉุฏูุง ูุนุงู:**
   ```sql
   SELECT * FROM discount_codes WHERE is_active = true;
   ```

2. **ุงุฌุงุฏ ฺฉุฏ ุชุณุช:**
   ```sql
   INSERT INTO discount_codes (code, type, value, is_active) 
   VALUES ('TEST20', 'percentage', 20, true);
   ```

## ๐๏ธ **ูุฑุงุญู ุนุจโุงุจ**

### **ูุฑุญูู 1: ุจุฑุฑุณ ุชูุธูุงุช**
```dart
// ุฏุฑ AppConfig ุจุฑุฑุณ ฺฉูุฏ:
print('Zibal Merchant ID: ${AppConfig.zibalMerchantId}');
print('Zarinpal Merchant ID: ${AppConfig.zarinpalMerchantId}');
```

### **ูุฑุญูู 2: ุชุณุช ุงุชุตุงู**
```dart
// ุชุณุช ูุณุชูู API
final response = await http.post(
  Uri.parse('https://gateway.zibal.ir/v1/request'),
  headers: {'Content-Type': 'application/json'},
  body: jsonEncode({
    'merchant': 'YOUR_MERCHANT_ID',
    'amount': 100000, // 10,000 Toman
    'callbackUrl': 'https://your-app.com/callback',
  }),
);
```

### **ูุฑุญูู 3: ุจุฑุฑุณ ูพุงฺฏุงู ุฏุงุฏู**
```sql
-- ุจุฑุฑุณ ูุฌูุฏ ุฌุฏุงูู
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name LIKE 'payment%';

-- ุจุฑุฑุณ RLS
SELECT schemaname, tablename, policyname, permissive, roles, cmd, qual 
FROM pg_policies 
WHERE tablename = 'payment_transactions';
```

## ๐ **ูพุดุชุจุงู**

### **ุฒุจุงู:**
- ๐ง ุงูู: support@zibal.ir
- ๐ ุชููู: 021-91001234
- ๐ ูุจโุณุงุช: [zibal.ir](https://zibal.ir)

### **ุฒุฑูโูพุงู:**
- ๐ง ุงูู: support@zarinpal.com
- ๐ ุชููู: 021-88665544
- ๐ ูุจโุณุงุช: [zarinpal.com](https://zarinpal.com)

## ๐ง **ูฺฉุงุช ููู**

1. **ููุดู ุฏุฑ ุญุงูุช ุชุณุช ุดุฑูุน ฺฉูุฏ**
2. **API keys ุฑุง ุฏุฑ ูุงูโูุง ุงูู ูฺฏูุฏุงุฑ ฺฉูุฏ**
3. **ูุจู ุงุฒ productionุ ุชูุงู ุชุณุชโูุง ุฑุง ุงูุฌุงู ุฏูุฏ**
4. **ูุงฺฏโูุง ุฑุง ุจุฑุฑุณ ฺฉูุฏ**
5. **Backup ูพุงฺฏุงู ุฏุงุฏู ุฏุงุดุชู ุจุงุดุฏ**

## โ **ฺฺฉโูุณุช ููุง**

- [ ] API keys ุตุญุญ ูุณุชูุฏ
- [ ] ุฌุฏุงูู ูพุงฺฏุงู ุฏุงุฏู ุงุฌุงุฏ ุดุฏูโุงูุฏ
- [ ] RLS policies ุชูุธู ุดุฏูโุงูุฏ
- [ ] ุชุณุช ุงุชุตุงู ูููู ุงุณุช
- [ ] ุชุณุช ูพุฑุฏุงุฎุช ูููู ุงุณุช
- [ ] ุชุณุช ฺฉู ูพูู ูููู ุงุณุช
- [ ] ุชุณุช ุงุดุชุฑุงฺฉ ูููู ุงุณุช
- [ ] ุชุณุช ฺฉุฏ ุชุฎูู ูููู ุงุณุช

---

**ูฺฉุชู:** ุงฺฏุฑ ูุดฺฉู ุญู ูุดุฏุ ูุงฺฏโูุง ฺฉุงูู ุฑุง ุจุฑุฑุณ ฺฉูุฏ ู ุจุง ุชู ูพุดุชุจุงู ุชูุงุณ ุจฺฏุฑุฏ.
