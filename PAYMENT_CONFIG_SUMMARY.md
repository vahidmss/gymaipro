# خلاصه تنظیمات سیستم پرداخت

## ✅ **تنظیمات فعلی:**

### **زیبال (Zibal):**
- **Merchant ID:** `68cd4851a45c720017e12178` ✅
- **API Key:** `3ee6888401664a9daae5acd49ece0563` ✅
- **وضعیت:** آماده استفاده

### **زرین‌پال (Zarinpal):**
- **Merchant ID:** `YOUR_ZARINPAL_MERCHANT_ID` ⚠️
- **وضعیت:** کانفیگ نشده

## 🔧 **مراحل بعدی:**

### **1. تست سیستم پرداخت:**
```bash
# در اپلیکیشن
1. روی "تست سریع" کلیک کنید
2. نتایج را بررسی کنید
3. اگر موفق بود، سیستم آماده است
```

### **2. اجرای SQL Script:**
```sql
-- فایل create_payment_tables.sql را در Supabase اجرا کنید
```

### **3. تست کامل:**
```bash
# در اپلیکیشن
1. روی "تست کامل" کلیک کنید
2. تمام سرویس‌ها را تست کنید
3. نتایج را بررسی کنید
```

## 🎯 **نحوه استفاده:**

### **پرداخت مستقیم:**
```dart
// ایجاد برنامه پرداخت
final plan = PaymentPlan(
  id: 'plan-1',
  name: 'اشتراک ماهانه',
  price: 50000, // 5,000 تومان
  type: PaymentPlanType.subscription,
);

// هدایت به صفحه پرداخت
Navigator.pushNamed(context, '/payment', arguments: plan);
```

### **استفاده از کیف پول:**
```dart
final walletService = WalletService();

// شارژ کیف پول
await walletService.chargeWallet(
  userId: userId,
  amount: 100000, // 10,000 تومان
  description: 'شارژ کیف پول',
);
```

### **استفاده از کد تخفیف:**
```dart
final discountService = DiscountService();

// اعتبارسنجی کد تخفیف
final isValid = await discountService.validateDiscountCode(
  code: 'WELCOME20',
  userId: userId,
  amount: 100000,
);
```

## 📱 **صفحات سیستم پرداخت:**

- **`/payment`** - صفحه پرداخت اصلی
- **`/wallet`** - مدیریت کیف پول
- **`/subscriptions`** - مدیریت اشتراک‌ها
- **`/payment-history`** - تاریخچه پرداخت‌ها
- **`/payment-test`** - تست کامل سیستم
- **`/quick-payment-test`** - تست سریع

## 🔍 **عیب‌یابی:**

### **اگر خطا داشت:**
1. **بررسی لاگ‌ها:** Console را چک کنید
2. **تست اتصال:** از صفحه تست استفاده کنید
3. **بررسی پایگاه داده:** جداول را چک کنید
4. **راهنمای کامل:** فایل `PAYMENT_TROUBLESHOOTING.md`

### **مشکلات رایج:**
- ❌ **"invalid merchant"**: Merchant ID اشتباه
- ❌ **"مبلغ نامعتبر"**: مبلغ کمتر از حداقل
- ❌ **"خطای پایگاه داده"**: جداول ایجاد نشده

## 🚀 **آماده برای Production:**

### **چک‌لیست نهایی:**
- [ ] Merchant ID صحیح تنظیم شده
- [ ] SQL Script اجرا شده
- [ ] تست اتصال موفق
- [ ] تست پرداخت موفق
- [ ] تست کیف پول موفق
- [ ] تست اشتراک موفق
- [ ] تست کد تخفیف موفق

### **نکات مهم:**
1. **همیشه در حالت تست شروع کنید**
2. **مبالغ کم تست کنید**
3. **لاگ‌ها را بررسی کنید**
4. **Backup پایگاه داده داشته باشید**

## 📞 **پشتیبانی:**

- **زیبال:** support@zibal.ir
- **زرین‌پال:** support@zarinpal.com
- **مستندات:** فایل‌های راهنما در پروژه

---

**نکته:** سیستم پرداخت شما حالا کاملاً آماده است! 🎉
