# راهنمای تست سیستم مدارک مربیان

## 🧪 **مراحل تست کامل**

### 1. **تست آپلود مدرک**

#### **مرحله 1: ورود مربی**
```bash
# وارد اپلیکیشن شوید
# با اکانت مربی لاگین کنید
# به بخش "میز کار" بروید
```

#### **مرحله 2: آپلود مدرک**
```bash
# روی "افزودن مدرک" کلیک کنید
# نوع مدرک را انتخاب کنید (مربیگری، قهرمانی، تحصیلات، تخصص، دستاورد، سایر)
# عنوان مدرک را وارد کنید
# تصویر مدرک را انتخاب کنید
# روی "آپلود مدرک" کلیک کنید
```

#### **تست‌های مورد انتظار:**
- ✅ فرم validation کار می‌کند
- ✅ تصویر آپلود می‌شود
- ✅ پیام موفقیت نمایش داده می‌شود
- ✅ مدرک با وضعیت "در انتظار تایید" ذخیره می‌شود

### 2. **تست نمایش مدارک مربی**

#### **مرحله 1: مشاهده مدارک خود**
```bash
# در بخش "پروفایل" میز کار
# بخش "مدارک من" را بررسی کنید
# مدارک با وضعیت‌های مختلف نمایش داده می‌شوند
```

#### **مرحله 2: مشاهده مدارک در رتبه‌بندی**
```bash
# به بخش "رتبه‌بندی مربیان" بروید
# روی یک مربی کلیک کنید
# بخش "مدارک" را بررسی کنید
# فقط مدارک تایید شده نمایش داده می‌شوند
```

#### **تست‌های مورد انتظار:**
- ✅ مدارک در انتظار تایید نمایش داده می‌شوند
- ✅ مدارک رد شده با دلیل رد نمایش داده می‌شوند
- ✅ مدارک تایید شده در بخش عمومی نمایش داده می‌شوند
- ✅ تصاویر به درستی لود می‌شوند

### 3. **تست تایید/رد مدارک (ادمین)**

#### **مرحله 1: ورود ادمین**
```bash
# با اکانت ادمین لاگین کنید
# به بخش مدیریت بروید
```

#### **مرحله 2: بررسی مدارک در انتظار**
```bash
# لیست مدارک در انتظار تایید را بررسی کنید
# روی هر مدرک کلیک کنید
# تصویر مدرک را مشاهده کنید
```

#### **مرحله 3: تایید/رد مدرک**
```bash
# روی "تایید" کلیک کنید
# یا روی "رد" کلیک کنید و دلیل وارد کنید
```

#### **تست‌های مورد انتظار:**
- ✅ ادمین می‌تواند مدارک را ببیند
- ✅ تایید/رد کار می‌کند
- ✅ وضعیت مدرک به‌روزرسانی می‌شود
- ✅ مربی از تغییر وضعیت مطلع می‌شود

### 4. **تست امنیت**

#### **تست دسترسی:**
```bash
# با اکانت عادی سعی کنید مدارک را تایید/رد کنید
# با اکانت مربی سعی کنید مدارک دیگران را ببینید
# با اکانت عادی سعی کنید مدرک آپلود کنید
```

#### **تست‌های مورد انتظار:**
- ❌ کاربران عادی نمی‌توانند مدرک آپلود کنند
- ❌ مربیان نمی‌توانند مدارک دیگران را ببینند
- ❌ کاربران عادی نمی‌توانند مدارک را تایید/رد کنند

### 5. **تست عملکرد**

#### **تست سرعت:**
```bash
# آپلود تصاویر مختلف (کوچک، متوسط، بزرگ)
# مشاهده لیست مدارک
# جستجو در مدارک
```

#### **تست‌های مورد انتظار:**
- ✅ آپلود تصاویر تا 5MB کار می‌کند
- ✅ لیست مدارک سریع لود می‌شود
- ✅ تصاویر به درستی نمایش داده می‌شوند

### 6. **تست خطاها**

#### **تست سناریوهای خطا:**
```bash
# آپلود بدون تصویر
# آپلود با عنوان خالی
# آپلود تصویر خیلی بزرگ
# آپلود با فرمت نامناسب
```

#### **تست‌های مورد انتظار:**
- ✅ پیام خطای مناسب نمایش داده می‌شود
- ✅ فرم reset نمی‌شود
- ✅ کاربر می‌تواند دوباره تلاش کند

## 🔍 **بررسی‌های فنی**

### 1. **بررسی Database**
```sql
-- بررسی جدول certificates
SELECT * FROM certificates ORDER BY created_at DESC;

-- بررسی آمار مدارک
SELECT status, COUNT(*) FROM certificates GROUP BY status;

-- بررسی فایل‌های storage
SELECT * FROM storage.objects WHERE bucket_id = 'coach_certificates';
```

### 2. **بررسی Logs**
```bash
# بررسی console logs
# بررسی network requests
# بررسی error logs
```

### 3. **بررسی Performance**
```bash
# بررسی memory usage
# بررسی network usage
# بررسی loading times
```

## 📊 **گزارش تست**

### **نتایج مورد انتظار:**
- ✅ آپلود مدارک: 100% موفق
- ✅ نمایش مدارک: 100% موفق
- ✅ تایید/رد مدارک: 100% موفق
- ✅ امنیت: 100% محافظت شده
- ✅ عملکرد: قابل قبول

### **نکات مهم:**
1. **تصاویر**: فقط JPG/PNG مجاز
2. **اندازه**: حداکثر 5MB
3. **امنیت**: RLS policies فعال
4. **عملکرد**: فایل‌ها بهینه شده

## 🚨 **مشکلات احتمالی**

### **مشکل 1: آپلود نمی‌شود**
- بررسی RLS policies
- بررسی bucket permissions
- بررسی network connection

### **مشکل 2: تصاویر نمایش داده نمی‌شوند**
- بررسی CORS settings
- بررسی public access
- بررسی URL generation

### **مشکل 3: تایید/رد کار نمی‌کند**
- بررسی admin permissions
- بررسی RLS policies
- بررسی function permissions

## 🔧 **راه‌حل‌های سریع**

### **Reset سیستم:**
```sql
-- حذف همه مدارک (فقط برای تست)
DELETE FROM certificates;
DELETE FROM storage.objects WHERE bucket_id = 'coach_certificates';
```

### **بررسی سلامت:**
```sql
-- بررسی سلامت فایل‌ها
SELECT * FROM check_certificate_file_health();

-- بررسی آمار storage
SELECT * FROM get_certificate_storage_stats();
```

## 📝 **گزارش نهایی**

پس از انجام همه تست‌ها، گزارشی شامل:
- ✅ تست‌های موفق
- ❌ تست‌های ناموفق
- 🔧 مشکلات و راه‌حل‌ها
- 📊 آمار عملکرد
- 💡 پیشنهادات بهبود

**تاریخ تست:** _________
**تست کننده:** _________
**نسخه:** _________
